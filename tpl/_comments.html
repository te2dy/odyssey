<tpl:EntryIf operator="or" comments_active="1" pings_active="1">
  <div id={{tpl:lang reactions}} class=reactions-block>

  <tpl:EntryIf operator="and" has_comment="1" has_ping="1">
    <h3 class=reaction-title>{{tpl:EntryCommentCount one="One reaction" more="%d reactions" count_all="1"}}</h3>
  </tpl:EntryIf>

  <tpl:EntryIf operator="and" has_comment="1" has_ping="0">
    <h3 class=reaction-title>{{tpl:EntryCommentCount one="One comment" more="%d comments"}}</h3>
  </tpl:EntryIf>

  <tpl:EntryIf operator="and" has_comment="0" has_ping="1">
    <h3 class=reaction-title>{{tpl:EntryPingCount one="One trackback" more="%d trackbacks"}}</h3>
  </tpl:EntryIf>
</tpl:EntryIf>

<tpl:EntryIf operator="or" show_comments="1" show_pings="1">
  <tpl:Comments with_pings="1">
    <tpl:CommentsHeader>
      <ul id=reactions-list>
    </tpl:CommentsHeader>

    <tpl:CommentIf is_ping="0">
      <li id={{tpl:lang comment}}-{{tpl:CommentID}} class="reaction comment {{tpl:CommentIfMe}} {{tpl:CommentIfOdd}} {{tpl:CommentIfFirst}}">
        <header class=comment-meta>
          <cite class=comment-author>{{tpl:CommentAuthorLink}}</cite><small class="comment-date text-secondary">, <a href=#{{tpl:lang comment}}-{{tpl:CommentID}}>{{tpl:CommentDate}} {{tpl:lang at}} {{tpl:CommentTime}}</a>{{tpl:lang :}}</small>
        </header>

        <div class="comment-content text">
          {{tpl:SysBehavior behavior="publicCommentBeforeContent"}}

          {{tpl:CommentContent}}

          {{tpl:SysBehavior behavior="publicCommentBeforeContent"}}
        </div>
    </tpl:CommentIf>

    <tpl:CommentIf is_ping="1">
      <li id={{tpl:lang trackback}}-{{tpl:PingID}} class="reaction ping {{tpl:PingIfOdd}} {{tpl:PingIfFirst}}">
        {{tpl:lang Trackback:}} <a class=ping-link href={{tpl:PingAuthorURL}} {{tpl:PingNoFollow}}>{{tpl:PingTitle}}</a>, <cite class=ping-author>{{tpl:PingBlogName}}</cite><small class="ping-date text-secondary">, <a href=#{{tpl:lang trackback}}-{{tpl:PingID}}>{{tpl:PingDate}}, {{tpl:PingTime}}</a></small>
      </li>
    </tpl:CommentIf>

    <tpl:CommentsFooter>
      </ul>
    </tpl:CommentsFooter>
  </tpl:Comments>
</tpl:EntryIf>

<tpl:EntryIf comments_active="1">
  <tpl:Block name="comment-alerts">
    <tpl:SysIfCommentPublished>
      <p class=comment-message id={{tpl:lang comment}}>
        ðŸŸ¢ {{tpl:lang Your comment has been published.}}
      </p>
    </tpl:SysIfCommentPublished>

    <tpl:SysIfCommentPending>
      <p class=comment-message id={{tpl:lang comment}}>
        ðŸŸ  {{tpl:lang Your comment has been submitted and will be reviewed for publication.}}
      </p>
    </tpl:SysIfCommentPending>

    <tpl:SysIfFormError>
      <p class=comment-message id={{tpl:lang comment}}>
        ðŸ”´ {{tpl:SysFormError}}
      </p>
    </tpl:SysIfFormError>
  </tpl:Block>

  <tpl:Block name="comment-form">
    <form action={{tpl:EntryURL}}#{{tpl:lang comment}} id=comment-form method=post>
      <tpl:Block name="comment-form-preview">
        <tpl:IfCommentPreview>
          <div id={{tpl:lang comment}} class=comment-preview>
            <h3>{{tpl:lang Previewing comment}}</h3>

            <div class="comment-content text">
              {{tpl:CommentPreviewContent}}
            </div>

            <input type=submit class=submit value="{{tpl:lang Send comment}}">
          </div>
        </tpl:IfCommentPreview>
      </tpl:Block>

      <tpl:Block name="comment-form-add">
        <h3 class=reaction-title>{{tpl:lang Write a comment}}</h3>

        {{tpl:SysBehavior behavior="publicCommentFormBeforeContent"}}

        <div class=form-entry>
          <label for=c_name>{{tpl:lang Name or nickname}}</label>
          <br>
          <input id=c_name name=c_name maxlength=255 value="{{tpl:CommentPreviewName encode_html="1"}}" required>
        </div>

        <div class=form-entry>
          <label for=c_mail>{{tpl:lang Email address}}</label>
          <br>
          <input id=c_mail name=c_mail type=email maxlength=255 value="{{tpl:CommentPreviewEmail encode_html="1"}}" required>
        </div>

        <div class=form-entry>
          <label for=c_site>{{tpl:lang URL of a personal account or website (optional)}}</label>
          <br>
          <input id=c_site name=c_site maxlength=255 placeholder=https://â€¦ value="{{tpl:CommentPreviewSite encode_html="1"}}">
        </div>

        <div class=form-entry>
          <label for=c_content>{{tpl:lang Your comment}}</label>
          <br>
          <textarea id=c_content name=c_content required rows=8>{{tpl:CommentPreviewContent raw="1" encode_html="1"}}</textarea>
        </div>

        {{tpl:SysBehavior behavior="publicCommentFormAfterContent"}}

        <div class=form-entry>
          <input type=submit name=preview value="{{tpl:lang Preview}}">

          <tpl:IfCommentPreviewOptional>
            <input type=submit value="{{tpl:lang Send}}">
          </tpl:IfCommentPreviewOptional>
        </div>
      </tpl:Block>
    </form>
  </tpl:Block>
</tpl:EntryIf>

<p class=text-secondary id=comment-feed-link>
  <tpl:EntryIf operator="and" comments_active="1" pings_active="1">
    <small><a href={{tpl:BlogFeedURL type="atom"}}/comments/{{tpl:EntryID}} rel=nofollow>{{tpl:lang Subscribe to reactions}}</a></small>
  </tpl:EntryIf>

  <tpl:EntryIf operator="and" comments_active="1" pings_active="0">
    <small><a href={{tpl:BlogFeedURL type="atom"}}/comments/{{tpl:EntryID}} rel=nofollow>{{tpl:lang Subscribe to comments}}</a></small>
  </tpl:EntryIf>

  <tpl:EntryIf operator="and" comments_active="0" pings_active="1">
    <small><a href={{tpl:BlogFeedURL type="atom"}}/comments/{{tpl:EntryID}} rel=nofollow>{{tpl:lang Subscribe to trackbacks}}</a></small>
  </tpl:EntryIf>
</p>

<tpl:EntryIf pings_active="1">
  <script>
    function origineTrackbackURLCopy() {
      // Gets the trackback button & URL.
      var trackbackButton  = document.getElementById("trackback-url"),
          trackbackURL     = trackbackButton.getAttribute("data-trackback-url");

      if (document.getElementById("trackback-url-copied")) {
        document.getElementById("trackback-url-copied").remove();
      }

      // Copies the trackback URL in the clipboard.
      navigator.clipboard.writeText(trackbackURL);

      // Displays a message to confirm the copy.
      trackbackButton.insertAdjacentHTML("afterend", ' <span id=trackback-url-copied>{{tpl:lang Copied}}</span>');
    }
  </script>

  <p class=text-secondary id=trackback-link-container>
    <small>{{tpl:lang Add a trackback:}}<br><span data-trackback-url={{tpl:EntryPingLink}} id=trackback-url onclick=origineTrackbackURLCopy();>{{tpl:EntryPingLink}}</span></small>
  </p>
</tpl:EntryIf>

<tpl:EntryIf operator="or" comments_active="1" pings_active="1">
  </div>
</tpl:EntryIf>
